# JavaScript对象

### Object对象

对象可以创建自有属性，还可以从为原型对象里面继承属性。

##### 创建对象的两种方式

- ```javascript
  var person = new Object();
  person.name = '孙悟空';
  person.age = 18;
  ```

- ```javascript
  var person = {
      name: "孙悟空",
      age: 18
  };
  ```

##### 对象属性的访问方式

- 对象.属性名

- 对象['属性名']

##### 栈和堆

JavaScript在运行时数据是保存在堆和栈中的。栈内存用来保存变量和基本类型，堆内存用来保存对象。变量指向一个对象，变量中实际保存的是对象在堆中的内存地址。

### 数组

数组也是对象的一种，是一种用于表达具有顺序关系的值的集合的数据结构。

##### 创建数组的方式

```javascript
var array = [1, 2, 3, 4];
```

### 函数

函数是一连串语句的集合，可以被外部程序所调用。向函数传递参数以后，函数可以返回一定的值。

如果只对函数进行了声明，函数中的代码并不会执行，只有调用函数时才会执行函数体内的代码。

函数也是一个对象。

##### 函数的声明

函数也是一个对象，因此函数也是在堆内存中保存。函数声明使用function关键字。

##### 函数的调用

调用函数时，传递给函数的参数称为实际参数，即实参。函数声明时设置的参数为形参。JS中所有的参数传递都是按值传递，就是把函数外部的值赋值给函数内部的参数，如同一个变量赋值给另外一个变量是一样的。

##### 执行环境

- 执行环境定义了变量或函数有权访问的其他数据，决定了它们各自的行为。

- 每个执行环境都有一个与之关联的变量对象，环境中定义的所有变量和函数都保存在这个对象中。

- 全局执行环境是最外围的一个执行环境。在 Web 浏览器中，全局执行环境被认为是 window 对象，因此所有全局变量和函数都是作为window 对象的属性和方法创建的。

- 某个执行环境中的所有代码执行完毕后，该环境被销毁，保存在其中的所有变量和函数定义也随之销毁。

- 在内部环境可以读取外部环境的变量，反之则不行。

##### 函数内部属性

两个特殊的属性

- arguments 该对象实际上是一个数组，用于保证函数的参数。该对象还有一个callee属性来表示当前函数。

- this this引用的的是一个对象，对于最外层代码与函数内部的情况，引用目标是不同的。在函数内部，根据函数调用的方式的不同，引用对象也会有所不同，this引用会根据代码的上下文语境自动改变其引用的对象。

##### this引用的规则

在最外层代码中，this引用的是全局对象。在函数内部，this根据函数的调用方式不同而有所不同。

| 函数的调用方式      | this引用的对象    |
| ------------ | ------------ |
| 构造函数         | 所生成的对象       |
| 调用对象的方法      | 当前对象         |
| apply或call调用 | 参数指定的对象      |
| 其他方式         | 全局对象（window） |

##### 构造函数

构造函数是用于生成对象的函数，像之前调用的Object()就是一个构造函数。

创建一个构造函数：

```javascript
function MyClass(x, y) {
    this.x = x;
    this.y = y;
}
```

调用构造函数：

- 构造函数本身和普通的函数声明形式相同。

- 构造函数通过new关键字来调用，new关键字会新创建一个对象返回。

- 通过new关键字调用的构造函数内的this引用了新生成的对象。

##### new关键字

- 构造函数都可以通过new来调用。

- 构造函数和普通函数的区别在于调用方式的不同。

- 任何函数都可以通过new来调用，所以函数都可以是构造函数。

- 在开发中，通常会区分用于执行的函数和构造函数。

- 构造函数的首字母需要大写。

##### 属性的访问

读取对象属性有两种方式：

- 对象.属性名

- 对象['属性名']

修改对象属性

    对象.属性名 = 属性值

删除属性

    delete 对象.属性名

constructor

    每个对象中都有一个constructor属性，它引用了当前对象的构造函数。

##### 垃圾回收

不再使用的对象的内存将会自动回收，所谓不再使用的对象，指的是没有被任何一个属性或者变量引用的对象。

### 原型继承

在构造函数中存在着一个名为原型（prototype）的对象，这个对象保存着一些属性，凡是通过该构造函数创建的对象都可以访问存在于原型中的属性。

最典型的原型属性就是toString()函数，我们的对象中并没有定义这个函数，但是却可以调用，那是因为这个函数存在于Object对应的原型中。

原型就是一个对象，和其他对象没有任何区别，可以通过构造函数来获取原型对象，构造函数.prototype。

和其他对象一样，我们可以添加删除修改原型中的属性，也可以修改原型对象的引用。需要注意的是prototye属性只存在于函数对象中，其他对象是没有prototype属性的，每一个对象都有原型，包括原型对象也有原型。特殊的是Object的原型对象没有原型。

##### 获取原型对象的方法

- 除了可以通过构造函数获取原型对象以外，还可以通过具体的对象来获取原型对象。
  
  - `Object.getPrototypeOf(对象)`
  
  - `对象.__proto__`
  
  - `对象.constructor.prototype`

- 需要注意的是，我们可以获取到Object的原型对象，也可以对它的属性进行操作，但是我们不能修改Object原型对象的引用。   

##### 原型链

每个对象都有原型对象，原型对象也有原型对象。由此，我们的对象和对象的原型，以及原型的原型就构成了一个原型链。

比如这么一个对象:

```javascript
var mc = new MyClass();
```

这个对象本身，原型MyClass.prototype原型对象的原型对象是Object，Object对象还有其原型，这就构成了一个原型链。这个链的次序是：mc对象、mc对象原型、原型的原型（Object）、Object的原型。当从一个对象中获取属性时，会首先从当前对象中查找，如果没有则顺着向上查找原型对象，直到找到Object对象的原型位置，找到则返回，找不到则返回undefined。


